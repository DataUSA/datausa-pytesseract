<Schema name="datausa" default_locale="en">
    <Cube name="ipeds_completions">
        <Annotation name="source_name">Integrated Postsecondary Education Data System (IPEDS)</Annotation>
        <Annotation name="source_link">https://nces.ed.gov/ipeds/use-the-data</Annotation>
        <Annotation name="dataset_name">Completions</Annotation>
        <Annotation name="dataset_link">https://nces.ed.gov/ipeds/datacenter/DataFiles.aspx</Annotation>
        <Annotation name="topic">Education</Annotation>
        <Annotation name="subtopic">Graduation</Annotation>
        <Annotation name="source_description">IPEDS is the Integrated Postsecondary Education Data System. It is a system of interrelated surveys conducted annually by the U.S. Department of Educationâ€™s National Center for Education Statistics (NCES). IPEDS gathers information from every college, university, and technical and vocational institution that participates in the federal student financial aid programs.</Annotation>

        <Table name="ipeds_completions" />

        <DimensionUsage foreign_key="university" name="University" source="University"  />  
        <DimensionUsage foreign_key="university" name="Geography" source="IPEDS Geography" />
        <DimensionUsage foreign_key="university" name="Sector" source="IPEDS Sector"/>
        <DimensionUsage foreign_key="cip" name="CIP" source="CIP" />
        <DimensionUsage foreign_key="ipeds_race" name="IPEDS Race" source="IPEDS Race"/>

        <Dimension name="Year" foreign_key="year" type="time">  
            <Annotation name="dim_type">TIME</Annotation>
            <Hierarchy name="Year" primary_key="year">
                <Level name="Year" key_column="year" key_type="u16"/>
            </Hierarchy>
        </Dimension>

        <Dimension foreign_key="degree" name="Degree">
          <Hierarchy name="Degree">
            <InlineTable name="dim_inline_degree" format="tuples">
                <Row>("id", "description")</Row>
                <Row>(1, "Less than 1 Year Postsecondary Certificate")</Row>
                <Row>(17, "Research Doctorate")</Row>
                <Row>(18, "Professional Doctorate")</Row>
                <Row>(19, "Other Doctorate")</Row>
                <Row>(2, "1 to 2 Year Postsecondary Certificate")</Row>
                <Row>(3, "Associates Degree")</Row>
                <Row>(4, "2 to 4 Year Postsecondary Certificate")</Row>
                <Row>(5, "Bachelors Degree")</Row>
                <Row>(6, "Postbaccalaureate Certificate")</Row>
                <Row>(7, "Masters Degree")</Row>
                <Row>(8, "Post-Masters Certificate")</Row>
            </InlineTable>
            <Level key_column="id" name="Degree" name_column="description" key_type="u8" />
          </Hierarchy>
        </Dimension>

        <Dimension foreign_key="sex" name="Gender">
          <Hierarchy name="Gender">
            <InlineTable name="dim_inline_gender" format="tuples">
                <Row>("id", "description")</Row>
                <Row>(1, "Men")</Row>
                <Row>(2, "Women")</Row>
            </InlineTable>
            <Level key_column="id" name="Gender" name_column="description" key_type="u8" />
          </Hierarchy>
        </Dimension>

        <Measure name="Completions" key_column="num_completions" aggregator="sum">
            <Annotation name="units_of_measurement">Degrees</Annotation>
            <Annotation name="details">Number of awards or degrees conferred</Annotation>
        </Measure>

        <!--<Measure name="Number Of Universities" key_column="university" aggregator="distinct-count">
            <Annotation name="details">Number of distinct universities aggregated</Annotation>
            <Annotation name="aggregation_method">distinct-count</Annotation>
            <Annotation name="units_of_measurement">Universities</Annotation>
        </Measure>

            <CalculatedMember dimension="Measures" name="All Completions At University" visible="false">
              <Formula>
                <![CDATA[
                    (Measures.[Completions],
                    [CIP].[CIP].[All CIPs])
                ]]>
              </Formula>
            </CalculatedMember>

            <CalculatedMember dimension="Measures" name="Completions Share Of University" visible="true">
              <Annotations>
                <Annotation name="units_of_measurement">Percentage</Annotation>
                <Annotation name="details">The completions in a particular course at a university divided by the total completions in the university across all courses.</Annotation>
                <Annotation name="hide_in_ui">true</Annotation>
                <Annotation name="hide_in_map">true</Annotation>
              </Annotations>
              <Formula>
                <![CDATA[
                IIF([Measures].[All Completions At University] > 0,
                    [Measures].[Completions] / [Measures].[All Completions At University], NULL)
                ]]>
              </Formula>
            </CalculatedMember>

            <CalculatedMember dimension="Measures" name="Completions Previous" visible="false">
              <Annotations>
                <Annotation name="details">Completions from 1 year ago.</Annotation>
              </Annotations>
              <Formula>
                <![CDATA[
                (ParallelPeriod([Year].[Year].[Year], 1, [Year].[Year].CurrentMember), [Measures].[Completions])
                ]]>
              </Formula>
              </CalculatedMember>

            <CalculatedMember dimension="Measures" name="Completions Growth" visible="true">
              <Annotations>
                <Annotation name="units_of_measurement">Growth</Annotation>
                <Annotation name="details">1-year growth rate in degrees completed.</Annotation>
              </Annotations>
              <Formula>
                <![CDATA[
                  IIF([Measures].[Completions Previous] > 0 AND [Measures].[Completions] >= 0,
                    ([Measures].[Completions] - [Measures].[Completions Previous]) / [Measures].[Completions Previous],
                    NULL
                  )
                ]]>
              </Formula>
            </CalculatedMember>-->
    </Cube>
</Schema>